CREATE DATABASE OBARATAO;

USE OBARATAO;

CREATE TABLE MESA (
 NR_MESA INTEGER NOT NULL PRIMARY KEY
 );

CREATE TABLE GARCON (
 NR_GARCON INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
 NOME VARCHAR(40) NOT NULL
);

 CREATE TABLE CONTA (
 NR_CONTA INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
 DATA DATE NOT NULL,
 HORA_ABERTURA TIME NOT NULL,
 HORA_FECHAMENTO TIME ,
 NR_MESA INTEGER NOT NULL,
 NR_GARCON INTEGER NOT NULL,
 FOREIGN KEY (NR_MESA) REFERENCES MESA (NR_MESA)
 ON DELETE RESTRICT, FOREIGN KEY (NR_GARCON) REFERENCES GARCON (NR_GARCON) ON DELETE RESTRICT
 );

CREATE TABLE ITEMCARDAPIO (
 NR_ITEM INTEGER NOT NULL PRIMARY KEY AUTO_INCREMENT,
 NOME VARCHAR(40) NOT NULL,
 DESCRICAO VARCHAR(70),
 PRECO NUMERIC(6,2) NOT NULL
 );

CREATE TABLE PEDIDO (
 NR_PEDIDO INTEGER NOT NULL AUTO_INCREMENT,
 NR_CONTA INTEGER NOT NULL,
 NR_ITEM INTEGER NOT NULL,
 QUANTIDADE INTEGER NOT NULL,
 PRECO_UNITARIO NUMERIC(6,2) NOT NULL,
 PRIMARY KEY (NR_PEDIDO, NR_CONTA, NR_ITEM),
 FOREIGN KEY (NR_CONTA) REFERENCES CONTA (NR_CONTA)
 ON DELETE RESTRICT,
 FOREIGN KEY (NR_ITEM) REFERENCES ITEMCARDAPIO (NR_ITEM)
 ON DELETE RESTRICT
); 

INSERT INTO GARCON VALUES (10,"JOSE RIBAMAR DE SA");
INSERT INTO GARCON VALUES (11,"MARIANA LASCASAS");
INSERT INTO GARCON VALUES (12,"LUCIANA ANTERO");
INSERT INTO MESA VALUES (1);
INSERT INTO MESA VALUES (2);
INSERT INTO MESA VALUES (3);
INSERT INTO MESA VALUES (4);
INSERT INTO MESA VALUES (5);
INSERT INTO MESA VALUES (6); 

INSERT INTO ITEMCARDAPIO VALUES (1096,"PIZZA ESPECIAL","MUSSARELA,PRESUNTO E PROVOLONE", 30.99); INSERT INTO ITEMCARDAPIO VALUES (1097,"PIZZA CALABRIA","MUSSARELA, BANANA E CANELA", 32.99);
INSERT INTO ITEMCARDAPIO VALUES (1098,"PICANHA NA CHAPA","PICANHA, BATATA FRITA E AIPIM", 40.50);
INSERT INTO ITEMCARDAPIO VALUES (1099,"FRANGO XADREZ","FRANGO FRITO, AIPIM E SALADA", 40.50);
INSERT INTO ITEMCARDAPIO VALUES (1100,"BATATA-FRITA","BATATA FRITA E QUEIJO RALADO", 20);
INSERT INTO CONTA VALUES (1,'2012-07-08','17:59','23:15', 3,11);
INSERT INTO CONTA VALUES (2,'2012-07-09','18:03',NULL, 3,12);
INSERT INTO CONTA VALUES (3,'2012-07-09','19:11',NULL, 4,12);
INSERT INTO PEDIDO VALUES (1,2,1096,2,30.99);
INSERT INTO PEDIDO VALUES (2, 2,1097,1,32.99);
INSERT INTO PEDIDO VALUES (3, 3,1098,4,40.5); 

